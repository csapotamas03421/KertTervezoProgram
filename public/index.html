<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="main.css">
    <title>Növény hozzáadása</title>
</head>
<body>
    <div id="alap">
        <div id="novenyHozzaadas">
            <h4>Növény hozzáadása</h4>

            <form action="/add" method="POST">
                <input type="text" placeholder="Magyar név" name="magyar" required><br><br>
                <input type="text" placeholder="Latin név" name="latin" required><br><br>
                <input type="text" placeholder="Faj" name="faj" required><br><br>
                <input type="text" placeholder="Fajta" name="fajta" required><br><br>
                <input type="number" placeholder="Sortáv (cm)" name="sortav" required><br><br>
                <input type="number" placeholder="Tőtáv (cm)" name="totav" required><br><br>
                <input type="text" placeholder="Szereti (növény, ...)" name="szereti"><br><br>
                <input type="text" placeholder="Nem szereti (növény, ...)" name="nem_szereti"><br><br>
                <button type="submit">Hozzáadás</button>
            </form>
        </div>

        <div id="kertmeretMegadasa">
            <h4>Kert méretének megadása</h4>

            <!-- FONTOS: a form NEM küldi el magát -->
            <form onsubmit="return false;">
                <input type="text" placeholder="Kert szélessége (m)" name="kert_szelessege" required><br><br>
                <input type="text" placeholder="Kert magassága" name="kert_magassaga" required><br><br>
                <input type="text" placeholder="Ágyasok szélessége (m)" name="agyasok_szelessege" required><br><br>
                <input type="text" placeholder="Ágyások magassága (m)" name="agyasok_magassaga" required><br><br>
                <input type="text" placeholder="Ágyások darabszáma" name="agyasok_darabszama" required><br><br>

                <button type="button" name="kert_szamitasa">Kert számítása</button>
                <button type="button" name="agyasok_szamitasa">Ágyások számítása</button>
                <button type="button" name="agyasokosszter_kis_kertter">Tervezés</button>
                <button type="button" name="agyas_reset">Ágyások újra megadása</button>
                <button type="button" name="kert_megjelenites">Megjelenítés</button>
            </form>
        </div>
    </div>

<script>
let jo_kert = false;

// Kert terület számítás
document.querySelector('button[name="kert_szamitasa"]').addEventListener('click', () => {
    const sz = parseFloat(document.querySelector('input[name="kert_szelessege"]').value);
    const m = parseFloat(document.querySelector('input[name="kert_magassaga"]').value);
    if (!isNaN(sz) && !isNaN(m)) alert(`A kert területe: ${sz * m} m²`);
});

// Ágyások összterület számítás
document.querySelector('button[name="agyasok_szamitasa"]').addEventListener('click', () => {
    const sz = parseFloat(document.querySelector('input[name="agyasok_szelessege"]').value);
    const m = parseFloat(document.querySelector('input[name="agyasok_magassaga"]').value);
    const db = parseInt(document.querySelector('input[name="agyasok_darabszama"]').value);
    if (!isNaN(sz) && !isNaN(m) && !isNaN(db)) alert(`Összterület: ${sz * m * db} m²`);
});

// Beleférnek-e?
document.querySelector('button[name="agyasokosszter_kis_kertter"]').addEventListener('click', () => {
    const kertT = parseFloat(document.querySelector('input[name="kert_szelessege"]').value)
               * parseFloat(document.querySelector('input[name="kert_magassaga"]').value);

    const agyasT = parseFloat(document.querySelector('input[name="agyasok_szelessege"]').value)
                 * parseFloat(document.querySelector('input[name="agyasok_magassaga"]').value)
                 * parseInt(document.querySelector('input[name="agyasok_darabszama"]').value);

    jo_kert = agyasT <= kertT;
    alert(jo_kert ? "Az ágyások elférnek." : "Nem férnek el.");
});

// Kert mentése + átirányítás
document.querySelector('button[name="kert_megjelenites"]').addEventListener('click', () => {
    if (!jo_kert) return alert("Előbb ellenőrizd, hogy elférnek-e!");

    const kertAdatok = {
        kert_szelessege: document.querySelector('input[name="kert_szelessege"]').value,
        kert_magassaga: document.querySelector('input[name="kert_magassaga"]').value,
        agyasok_szelessege: document.querySelector('input[name="agyasok_szelessege"]').value,
        agyasok_magassaga: document.querySelector('input[name="agyasok_magassaga"]').value,
        agyasok_darabszama: document.querySelector('input[name="agyasok_darabszama"]').value
    };

    fetch("/saveGarden", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(kertAdatok)
    })
    .then(r => r.text())
    .then(() => window.location.href = "kert_megjelenites.html");
});

// Reset
document.querySelector('button[name="agyas_reset"]').addEventListener('click', () => {
    document.querySelector('input[name="agyasok_szelessege"]').value = "";
    document.querySelector('input[name="agyasok_magassaga"]').value = "";
    document.querySelector('input[name="agyasok_darabszama"]').value = "";
});
</script>

</body>
</html>